  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   JSONSQL07A
     Library  . . . . . . . . . . . :     NOXDB
   Text 'description' . . . . . . . :   *SRCMBRTXT
   Source stream file   . . . . . . :   JSONSQL07A.RPGLE
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   17-07-19  14:54:54
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *UNREF     *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
                                    :   /prj/noxdb
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                     ï»¿              000001
      2    //  ------------------------------------------------------------- *                                               000002
      3    //  -- Procedure returns a resultset                                                                              000003
      4    //  --------------------------------                                                                              000004
      5    //  CREATE or replace PROCEDURE  qgpl.custlist  (                                                                 000005
      6    //  in custName varchar(20) default null                                                                          000006
      7    //  )                                                                                                             000007
      8    //  LANGUAGE SQL                                                                                                  000008
      9    //  DYNAMIC RESULT SETS 1                                                                                         000009
     10                                                                                                                      000010
     11    //  BEGIN                                                                                                         000011
     12                                                                                                                      000012
     13    //      DECLARE c1 CURSOR WITH RETURN FOR                                                                         000013
     14    //        select *                                                                                                000014
     15    //        from   qiws.QCUSTCDT                                                                                    000015
     16    //        where  custName is null                                                                                 000016
     17    //        or     upper(lstnam) like '%' concat upper(custName) concat '%';                                        000017
     18    //                                                                                                                000018
     19    //      OPEN c1;                                                                                                  000019
     20                                                                                                                      000020
     21    //  END;                                                                                                          000021
     22                                                                                                                      000022
     23                                                                                                                      000023
     24    //   call qgpl.custList();                                                                                        000024
     25    //   call qgpl.custList(custName=>'john');                                                                        000025
     26                                                                                                                      000026
     27                                                                                                                      000027
     28    Ctl-Opt BndDir('NOXDB') dftactgrp(*NO) ACTGRP('QILE' );                                                           000028
     29                                                                                                                      000029
     30    //------------------------------------------------------------- *                                                 000030
     31                                                                                                                      000031
     32    /include 'headers/JSONPARSER.rpgle'                                                                               000032
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  JSONPARSE+                                                   *                     1
         * External name  . . . . . . :  ./../headers/JSONPARSER.rpgle                                *                     1
         * Last change  . . . . . . . :  17-07-19  15:16:36                                           *                     1
         *--------------------------------------------------------------------------------------------*
     33+   //---------------------------------------------------------------------- *                                       1000001
     34+   //This is the prototype for BlueSeries/IceBreak - JSON and XML parser                                            1000002
     35+   //Use the JSONXML binddir when creating your program and include this                                            1000003
     36+   //prototypes like:                                                                                               1000004
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     37+                                                                                                                    1000005
     38+   //H BNDDIR('JSONPARSER')                                                                                         1000006
     39+   ///include jsonParser                                                                                            1000007
     40+                                                                                                                    1000008
     41+   //Or                                                                                                             1000009
     42+                                                                                                                    1000010
     43+   //H BNDDIR('XMLPARSER')                                                                                          1000011
     44+   ///include xmlParser                                                                                             1000012
     45+                                                                                                                    1000013
     46+   //Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                             1000014
     47+   //the JSONXML header. so please do not make any changes th there headerfi                                        1000015
     48+                                                                                                                    1000016
     49+   //Note: all binddirectories JSONPARSER, XMLPARSER and JSONXML is the same                                        1000017
     50+   //---------------------------------------------------------------------- *                                       1000018
     51+ /if defined( json_DEF)                                                                                             1000019
             LINES EXCLUDED: 1
     52+ /endif                                                                                                             1000021
     53+ /define  json_DEF                                                                                                  1000022
     54+   //---------------------------------------------------------------------- *                                       1000023
     55+   //Before starting that parser - to enshure right enterpretations of delimi                                       1000024
     56+   //Usage:                                                                                                         1000025
     57+   //jx_setDelimiters( json_DELIMITERS);                                                                            1000026
     58+   //--------------------------------------------------------------------- *                                        1000027
     59+   //get delimiter pointer                                                                                          1000028
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *NOSRCSTMT        *
         *                                       *DEBUGIO   *UNREF            *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   NOXDB                        *
         *    Library  . . . . . . . . . . . :     *LIBL                      *
         *  Activation group . . . . . . . . :   QILE                         *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
     60+   Dcl-PR json_getDelimiters Pointer extproc(*CWIDEN :'jx_GetDelimiters');                                          1000029
     61+   End-PR;                                                                                                          1000030
     62+   //Set delimiter used for locate expression                                                                       1000031
     63+   Dcl-PR json_setDelimiters  extproc(*CWIDEN :'jx_SetDelimiters2');                                                1000032
     64+     //always: '/\Ø#¤ .æå' in your  local CCSID                                                                     1000033
     65+     delimiterStr   Pointer    value options(*string);                                                              1000034
     66+   End-PR;                                                                                                          1000035
     67+                                                                                                                    1000036
     68+   Dcl-C json_DELIMITERS const('/\Ø#¤ .æå''"');                                                                     1000037
     69+                                                                                                                    1000038
     70+   //---------------------------------------------------------------------- *                                       1000039
     71+   //Type of a node:                                                                                                1000040
     72+   //---------------------------------------------------------------------- *                                       1000041
     73+   Dcl-C json_UNKNOWN const(0);                                                                                     1000042
     74+   Dcl-C json_OBJECT  const(1);                                                                                     1000043
     75+   Dcl-C json_ARRAY   const(2);                                                                                     1000044
     76+   Dcl-C json_EVAL    const(3);                                                                                     1000045
     77+   Dcl-C json_POINTER_VALUE const(4);                                                                               1000046
     78+   Dcl-C json_VALUE   const(5);                                                                                     1000047
     79+   Dcl-C json_ROOT    const(6);                                                                                     1000048
     80+   Dcl-C json_LITERAL const(16);                                                                                    1000049
     81+   Dcl-C json_OBJLINK const(17);                                                                                    1000050
     82+   Dcl-C json_OBJREPLACE const(18);                                                                                 1000051
     83+   Dcl-C json_OBJCOPY const(18);                                                                                    1000052
     84+   Dcl-C json_BY_CONTEXT const(19);                                                                                 1000053
     85+   Dcl-C json_OBJMOVE const(2048);                                                                                  1000054
     86+                                                                                                                    1000055
     87+   //* Modifiers to "add" / "or" into "parseString" and "evaluate"                                                  1000056
     88+   //!! Type - have to be backwards compat.                                                                         1000057
     89+   //Unlink the source and move it to dest.                                                                         1000058
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     90+   Dcl-C json_MOVE_MODES const(2048);                                                                               1000059
     91+   //Allow strings ints and other values to                                                                         1000060
     92+   Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                         1000061
     93+                                                                                                                    1000062
     94+   //* Combinations:                                                                                                1000063
     95+   //JX_PARSE  = json_EVAL + json_MOVE_NODES                                                                        1000064
     96+   Dcl-C json_PARSE   const(2051);                                                                                  1000065
     97+                                                                                                                    1000066
     98+   //Merge options:                                                                                                 1000067
     99+   //Modifiers to "add" / "or" into "JSON_EVAL"                                                                     1000068
    100+ /if not defined(MO_MERGE)                                                                                          1000069
    101+ /define  MO_MERGE                                                                                                  1000070
    102+   //Only new elements are merged - existing                                                                        1000071
    103+   //are left untouched                                                                                             1000072
    104+   Dcl-C MO_MERGE_NEW const(256);                                                                                   1000073
    105+   //Merge and replace only existing nodes.                                                                         1000074
    106+   Dcl-C MO_MERGE_MATCH const(512);                                                                                 1000075
    107+   //Merge all: replace if it exists and                                                                            1000076
    108+   //append new nodes if not exists                                                                                 1000077
    109+   Dcl-C MO_MERGE_REPLACE const(1024 );                                                                             1000078
    110+ /endif                                                                                                             1000079
    111+                                                                                                                    1000080
    112+   Dcl-C json_CHILD_LIST const('#0¤');                                                                              1000081
    113+                                                                                                                    1000082
    114+   //---------------------------------------------------------------------- *                                       1000083
    115+   //Returns node to the json_object tree                                                                           1000084
    116+   Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'jx_ParseFile');                                                   1000085
    117+     //File to parse                                                                                                1000086
    118+     FileName       Pointer    value options(*string);                                                              1000087
    119+     //Parsing options                                                                                              1000088
    120+     Options        Pointer    value options(*string:*nopass);                                                      1000089
    121+   End-PR;                                                                                                          1000090
    122+                                                                                                                    1000091
    123+   //Returns node json_object tree                                                                                  1000092
    124+   Dcl-PR json_ParseString Pointer extproc(*CWIDEN:'jx_ParseString');                                               1000093
    125+     //String to parse                                                                                              1000094
    126+     String         Pointer    value options(*string);                                                              1000095
    127+     //Parsing options                                                                                              1000096
    128+     Options        Pointer    value options(*string:*nopass);                                                      1000097
    129+   End-PR;                                                                                                          1000098
    130+                                                                                                                    1000099
    131+   //Set , or . for numeri decimal point                                                                            1000100
    132+   Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'jx_SetDecPoint');                                                    1000101
    133+     //decimal point char                                                                                           1000102
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    134+     decPoint       Pointer    value options(*string);                                                              1000103
    135+   End-PR;                                                                                                          1000104
    136+                                                                                                                    1000105
    137+   //Bool true if errors occures                                                                                    1000106
    138+   Dcl-PR json_Error Ind extproc(*CWIDEN:'jx_Error');                                                               1000107
    139+     //jx_Object  node                                                                                              1000108
    140+     pNode          Pointer    value;                                                                               1000109
    141+   End-PR;                                                                                                          1000110
    142+                                                                                                                    1000111
    143+   //Return error description                                                                                       1000112
    144+   Dcl-PR json_Message Varchar(1024) extproc(*CWIDEN:'jx_Message');                                                 1000113
    145+     //jx_Object                                                                                                    1000114
    146+     pNode          Pointer    value;                                                                               1000115
    147+   End-PR;                                                                                                          1000116
    148+                                                                                                                    1000117
    149+   // Without parameters you will get the last internal error                                                       1000118
    150+   // Otherwise it will format an error object                                                                      1000119
    151+   Dcl-PR json_GetMessageObject Pointer //Return error description                                  I               1000120
    152+                              extproc(*CWIDEN:'jx_GetMessageObject');                                               1000121
    153+     MessageId      Pointer    value options(*string:*nopass);                                      I               1000122
    154+     MessageData    Pointer    value options(*string:*nopass);                                      I               1000123
    155+   End-PR;                                                                                                          1000124
    156+                                                                                                                    1000125
    157+   // simple courtesy function to return a æ"success":trueå object                                                  1000126
    158+   //Return success:true object                                                                                     1000127
    159+   Dcl-PR json_SuccessTrue Pointer extproc(*CWIDEN:'jx_SuccessTrue');                               I               1000128
    160+     MessageId      Pointer    value options(*string:*nopass);                                      I               1000129
    161+     MessageData    Pointer    value options(*string:*nopass);                                      I               1000130
    162+   End-PR;                                                                                                          1000131
    163+                                                                                                                    1000132
    164+   //Returns pointer to node                                                                                        1000133
    165+   Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'jx_GetNode');                                                      1000134
    166+     //Pointer to tree or node                                                                                      1000135
    167+     pNode          Pointer    value;                                                                               1000136
    168+     //location expression                                                                                          1000137
    169+     Expression     Pointer    value options(*string);                                                              1000138
    170+   End-PR;                                                                                                          1000139
    171+                                                                                                                    1000140
    172+   //Returns pointer to node                                                                                        1000141
    173+   Dcl-PR json_LocateOrCreate Pointer                                                                               1000142
    174+                            extproc(*CWIDEN : 'jx_GetOrCreateNode');                                                1000143
    175+     //Pointer to tree or node                                                                                      1000144
    176+     pNode          Pointer    value;                                                                               1000145
    177+     //location expression                                                                                          1000146
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    178+     Expression     Pointer    value options(*string);                                                              1000147
    179+   End-PR;                                                                                                          1000148
    180+                                                                                                                    1000149
    181+   //Returns 'ON' if node exists                                                                                    1000150
    182+   Dcl-PR json_Has Ind extproc(*CWIDEN : 'jx_Has');                                                                 1000151
    183+     //Pointer to tree or node                                                                                      1000152
    184+     pNode          Pointer    value;                                                                               1000153
    185+     //Path to node                                                                                                 1000154
    186+     NodeName       Pointer    value options(*string);                                                              1000155
    187+   End-PR;                                                                                                          1000156
    188+                                                                                                                    1000157
    189+   //Returns 'ON' if node exists and has <> 0                                                                       1000158
    190+   Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'jx_IsTrue');                                                           1000159
    191+     //Pointer to tree or node                                                                                      1000160
    192+     pNode          Pointer    value;                                                                               1000161
    193+     //Path to node                                                                                                 1000162
    194+     NodeName       Pointer    value options(*string);                                                              1000163
    195+   End-PR;                                                                                                          1000164
    196+                                                                                                                    1000165
    197+   //Returns 'ON' if node exists and has <> 0                                                                       1000166
    198+   Dcl-PR json_isNull Ind extproc(*CWIDEN : 'jx_IsNull');                                                           1000167
    199+     //Pointer to tree or node                                                                                      1000168
    200+     pNode          Pointer    value;                                                                               1000169
    201+     //Path to node                                                                                                 1000170
    202+     NodeName       Pointer    value options(*string);                                                              1000171
    203+   End-PR;                                                                                                          1000172
    204+                                                                                                                    1000173
    205+   //Returns 'ON' if it is a valid node                                                                             1000174
    206+   Dcl-PR json_isNode Ind extproc(*CWIDEN : 'jx_isNode');                                                           1000175
    207+     //a.k.a. false for strings                                                                                     1000176
    208+     pNode          Pointer    value;                                                                               1000177
    209+   End-PR;                                                                                                          1000178
    210+                                                                                                                    1000179
    211+   //renames the node name                                                                                          1000180
    212+   Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'jx_NodeRename');                                                   1000181
    213+     //Pointer to tree or node                                                                                      1000182
    214+     pNode          Pointer    value;                                                                               1000183
    215+     //Path to node                                                                                                 1000184
    216+     NodeName       Pointer    value options(*string);                                                              1000185
    217+   End-PR;                                                                                                          1000186
    218+                                                                                                                    1000187
    219+   //Returns pointer to next sibling (elem)                                                                         1000188
    220+   Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                                 1000189
    221+     //Pointer to current node (elem)                                                                               1000190
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    222+     pNode          Pointer    value;                                                                               1000191
    223+   End-PR;                                                                                                          1000192
    224+                                                                                                                    1000193
    225+   //Returns pointer to first child (elem)                                                                          1000194
    226+   Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                               1000195
    227+     //Pointer to current node (elem)                                                                               1000196
    228+     pNode          Pointer    value;                                                                               1000197
    229+   End-PR;                                                                                                          1000198
    230+                                                                                                                    1000199
    231+   //Returns pointer to parent node                                                                                 1000200
    232+   Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'jx_GetNodeParent');                                             1000201
    233+     //Pointer to current node (elem)                                                                               1000202
    234+     pNode          Pointer    value;                                                                               1000203
    235+   End-PR;                                                                                                          1000204
    236+                                                                                                                    1000205
    237+   Dcl-PR json_SetEval pointer extproc(*CWIDEN:'jx_SetEvalByName');                                                 1000206
    238+     pNode          Pointer    value;                                                                               1000207
    239+     Expresion      Pointer    value options(*string);                                                              1000208
    240+     Value          Pointer    value options(*string);                                                              1000209
    241+   End-PR;                                                                                                          1000210
    242+                                                                                                                    1000211
    243+   Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'jx_SetStrByName');                                                  1000212
    244+     //Pointer to json_ tree                                                                                        1000213
    245+     pNode          Pointer    value;                                                                               1000214
    246+     //X-path locations to node or attributes                                                                       1000215
    247+     Expresion      Pointer    value options(*string);                                                              1000216
    248+     //New value to set / pointer to object                                                                         1000217
    249+     Value          Pointer    value options(*string);                                                              1000218
    250+   End-PR;                                                                                                          1000219
    251+                                                                                                                    1000220
    252+   Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'jx_SetIntByName');                                                  1000221
    253+     //Pointer to json_ tree                                                                                        1000222
    254+     pNode          Pointer    value;                                                                               1000223
    255+     //X-path locations to node or attributes                                                                       1000224
    256+     Expresion      Pointer    value options(*string);                                                              1000225
    257+     //New value to set / pointer to object                                                                         1000226
    258+     Value          Int(10)    value;                                                                               1000227
    259+   End-PR;                                                                                                          1000228
    260+                                                                                                                    1000229
    261+   Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1000230
    262+     //Pointer to json_ tree                                                                                        1000231
    263+     pNode          Pointer    value;                                                                               1000232
    264+     //X-path locations to node or attributes                                                                       1000233
    265+     Expresion      Pointer    value options(*string);                                                              1000234
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    266+     //New value to set / pointer to object                                                                         1000235
    267+     Value          Packed(30:15) value;                                                                            1000236
    268+   End-PR;                                                                                                          1000237
    269+                                                                                                                    1000238
    270+   Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'jx_SetBoolByName');                                                1000239
    271+     //Pointer to json_ tree                                                                                        1000240
    272+     pNode          Pointer    value;                                                                               1000241
    273+     //X-path locations to node or attributes                                                                       1000242
    274+     Expresion      Pointer    value options(*string);                                                              1000243
    275+     //New value to set / pointer to object                                                                         1000244
    276+     Value          Ind        value;                                                                               1000245
    277+   End-PR;                                                                                                          1000246
    278+                                                                                                                    1000247
    279+   Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                                  1000248
    280+     //Pointer to json_ tree                                                                                        1000249
    281+     pNode          Pointer    value;                                                                               1000250
    282+     //X-path locations to node or attributes                                                                       1000251
    283+     Expresion      Pointer    value options(*string);                                                              1000252
    284+     //Pointer to anything - You do the cleanup                                                                     1000253
    285+     Value          Pointer    value;                                                                               1000254
    286+   End-PR;                                                                                                          1000255
    287+                                                                                                                    1000256
    288+   Dcl-PR json_SetProcPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                              1000257
    289+     pNode          Pointer    value; //Pointer to json_ tree                                                       1000258
    290+     //X-path locations to node or attributes                                                                       1000259
    291+     Expresion      Pointer    value options(*string);                                                              1000260
    292+     Proc           Pointer(*Proc); //Pointer to a procedure                                                        1000261
    293+     //*ON=String escape, *OFF=If literals                                                                          1000262
    294+     isString       Ind        value options(*nopass);                                                              1000263
    295+   End-PR;                                                                                                          1000264
    296+                                                                                                                    1000265
    297+   Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'jx_SetValueByName');                                              1000266
    298+     //Pointer to json_ tree                                                                                        1000267
    299+     pNode          Pointer    value;                                                                               1000268
    300+     //X-path locations to node or attributes                                                                       1000269
    301+     Expresion      Pointer    value options(*string);                                                              1000270
    302+     //New value to set / pointer to object                                                                         1000271
    303+     Value          Pointer    value options(*string:*nopass);                                                      1000272
    304+     //Optional new type (Refer "node type"                                                                         1000273
    305+     Type           Uns(5)     value options(*nopass);                                                              1000274
    306+   End-PR;                                                                                                          1000275
    307+                                                                                                                    1000276
    308+   Dcl-PR json_GetValueStr Varchar(32767)                                                                           1000277
    309+                         extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                    1000278
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    310+     //Pointer to node                                                                                              1000279
    311+     pNode          Pointer    value;                                                                               1000280
    312+     //If not found - default value                                                                                 1000281
    313+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000282
    314+   End-PR;                                                                                                          1000283
    315+                                                                                                                    1000284
    316+   Dcl-PR json_GetValueNum Packed(30:15)                                                                            1000285
    317+                         extproc(*CWIDEN : 'jx_GetNodeValueNum');                                                   1000286
    318+     //Pointer to node                                                                                              1000287
    319+     pNode          Pointer    value;                                                                               1000288
    320+     //If not found - default value                                                                                 1000289
    321+     Defaultvalue   Packed(30:15) value options(*NOPASS);                                                           1000290
    322+   End-PR;                                                                                                          1000291
    323+                                                                                                                    1000292
    324+   Dcl-PR json_GetValueInt Int(20) extproc(*CWIDEN : 'jx_GetNodeValueInt');                         I               1000293
    325+     pNode          Pointer    value; //Pointer to node                                             I               1000294
    326+     //If not found - default value                                                                                 1000295
    327+     Defaultvalue   Int(20)    value options(*NOPASS);                                              I               1000296
    328+   End-PR;                                                                                                          1000297
    329+                                                                                                                    1000298
    330+   Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'jx_GetNodeValuePtr');                                         1000299
    331+     //Pointer to node                                                                                              1000300
    332+     pNode          Pointer    value;                                                                               1000301
    333+     //If not found - default value                                                                                 1000302
    334+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000303
    335+   End-PR;                                                                                                          1000304
    336+                                                                                                                    1000305
    337+   Dcl-PR json_GetName Varchar(32767)                                                                               1000306
    338+                     extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                         1000307
    339+     //Pointer to node                                                                                              1000308
    340+     pNode          Pointer    value;                                                                               1000309
    341+   End-PR;                                                                                                          1000310
    342+                                                                                                                    1000311
    343+   Dcl-PR json_GetNameAsPath Varchar(32767)                                                                         1000312
    344+                           extproc(*CWIDEN : 'jx_GetNodeNameAsPath');                                               1000313
    345+     //Pointer to node                                                                                              1000314
    346+     pNode          Pointer    value;                                                                               1000315
    347+     //Delimiter like - or . or / or \                                                                              1000316
    348+     Delimiter      Char(1)    value;                                                                               1000317
    349+   End-PR;                                                                                                          1000318
    350+                                                                                                                    1000319
    351+   //* Refer to node type above                                                                                     1000320
    352+   Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                                 1000321
    353+     //Pointer to json_ tree to receive format                                                                      1000322
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    354+     pNode          Pointer    value;                                                                               1000323
    355+   End-PR;                                                                                                          1000324
    356+                                                                                                                    1000325
    357+ // Get string by expresion                                                                                         1000326
    358+ //  /object/array#123¤/name                                                                                        1000327
    359+ //  .object.array#123¤.name                                                                                        1000328
    360+   Dcl-PR json_GetStr Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                            1000329
    361+     //Pointer to relative node                                                                                     1000330
    362+     pNode          Pointer    value;                                                                               1000331
    363+     //Locations expression to node                                                                                 1000332
    364+     Expression     Pointer    value options(*string:*nopass);                                                      1000333
    365+     //If not found - default value                                                                                 1000334
    366+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000335
    367+   End-PR;                                                                                                          1000336
    368+                                                                                                                    1000337
    369+ //  will join all subsequent array nodes into one resulting string                                                 1000338
    370+   Dcl-PR json_GetStrJoin Varchar(32767)                                                                            1000339
    371+                        extproc(*CWIDEN : 'jx_GetStrJoinVC');                                                       1000340
    372+     //Pointer to relative node                                                                                     1000341
    373+     pNode          Pointer    value;                                                                               1000342
    374+     //Locations expression to node                                                                                 1000343
    375+     Expression     Pointer    value options(*string:*nopass);                                                      1000344
    376+     //If not found - default value                                                                                 1000345
    377+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000346
    378+   End-PR;                                                                                                          1000347
    379+                                                                                                                    1000348
    380+ // Get number by expresion like:                                                                                   1000349
    381+ //  /object/array#123¤/name                                                                                        1000350
    382+ //  .object.array#123¤.name                                                                                        1000351
    383+   Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'jx_GetValueNum');                                            1000352
    384+     //Pointer to relative node                                                                                     1000353
    385+     pNode          Pointer    value;                                                                               1000354
    386+     //Locations expression to node                                                                                 1000355
    387+     Expression     Pointer    value options(*string:*nopass);                                                      1000356
    388+     //If not found - default value                                                                                 1000357
    389+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1000358
    390+   End-PR;                                                                                                          1000359
    391+                                                                                                                    1000360
    392+   Dcl-PR json_GetInt Int(20) extproc(*CWIDEN : 'jx_GetValueInt');                                                  1000361
    393+     //Pointer to relative node                                                                                     1000362
    394+     pNode          Pointer    value;                                                                               1000363
    395+     //Locations expression to node                                                                                 1000364
    396+     Expression     Pointer    value options(*string:*nopass);                                                      1000365
    397+     //If not found - default value                                                                                 1000366
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    398+     Defaultvalue   Int(20)    value options(*nopass);                                                              1000367
    399+   End-PR;                                                                                                          1000368
    400+                                                                                                                    1000369
    401+   //Set an ILOB object to a value found by X                                                                       1000370
    402+   //Return *ON if found                                                                                            1000371
    403+   Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                                               1000372
    404+     //Pointer to ILOB object to receive the va                                                                     1000373
    405+     pIlob          Pointer    value;                                                                               1000374
    406+     //Pointer to tree                                                                                              1000375
    407+     pNode          Pointer    value;                                                                               1000376
    408+     //X-path locations to node or attributes                                                                       1000377
    409+     Expression     Pointer    value options(*string);                                                              1000378
    410+   End-PR;                                                                                                          1000379
    411+                                                                                                                    1000380
    412+   Dcl-PR json_CopyValue Pointer extproc(*CWIDEN : 'jx_CopyValue');                                                 1000381
    413+     //destination node                                                                                             1000382
    414+     pDest          Pointer    value;                                                                               1000383
    415+     //destiantion name (or *NULL or '')                                                                            1000384
    416+     destName       Pointer    value options(*string);                                                              1000385
    417+     //source node                                                                                                  1000386
    418+     pSource        Pointer    value;                                                                               1000387
    419+     //source name (or *NULL or '')                                                                                 1000388
    420+     sourceName     Pointer    value options(*string);                                                              1000389
    421+   End-PR;                                                                                                          1000390
    422+                                                                                                                    1000391
    423+   Dcl-PR json_NodeCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                           1000392
    424+     //node. Retrive from Locate()                                                                                  1000393
    425+     pRootNode      Pointer    value;                                                                               1000394
    426+     //node. Retrive from Locate()                                                                                  1000395
    427+     pNewChild      Pointer    value;                                                                               1000396
    428+     //Reference location to where it arrive                                                                        1000397
    429+     RefLocation    Int(10)    value;                                                                               1000398
    430+   End-PR;                                                                                                          1000399
    431+                                                                                                                    1000400
    432+   //Following constants used by json_NodeCopy:RefLocation                                                          1000401
    433+   Dcl-C json_FIRST_CHILD const(1);                                                                                 1000402
    434+   Dcl-C json_LAST_CHILD const(2);                                                                                  1000403
    435+   Dcl-C json_BEFORE_SIBLING const(3);                                                                              1000404
    436+   Dcl-C json_AFTER_SIBLING const(4);                                                                               1000405
    437+                                                                                                                    1000406
    438+   Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'jx_NodeClone');                                                 1000407
    439+     //node. Retrive from Locate()                                                                                  1000408
    440+     pSource        Pointer    value;                                                                               1000409
    441+   End-PR;                                                                                                          1000410
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    442+                                                                                                                    1000411
    443+   //returns the new node                                                                                           1000412
    444+   Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                     1000413
    445+     //node. Retrive from Locate()                                                                                  1000414
    446+     pRootNode      Pointer    value;                                                                               1000415
    447+     //Reference location to where it arrive                                                                        1000416
    448+     RefLocation    Int(10)    value;                                                                               1000417
    449+     //Name of node                                                                                                 1000418
    450+     Name           Pointer    value options(*string);                                                              1000419
    451+     //Value or expression                                                                                          1000420
    452+     Value          Pointer    value options(*string);                                                              1000421
    453+     //New type (Refer "node type"                                                                                  1000422
    454+     Type           Uns(5)     value;                                                                               1000423
    455+   End-PR;                                                                                                          1000424
    456+                                                                                                                    1000425
    457+   Dcl-PR json_NodeDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                       1000426
    458+     //node. Retrive from Locate()                                                                                  1000427
    459+     pRootNode      Pointer    value;                                                                               1000428
    460+   End-PR;                                                                                                          1000429
    461+                                                                                                                    1000430
    462+   //Unlink the note from its previous and promote it as a new root node                                            1000431
    463+   Dcl-PR json_NodeUnlink Pointer extproc(*CWIDEN : 'jx_NodeUnlink');                                               1000432
    464+     //Targenode. Retrive from Locate(                                                                              1000433
    465+     pNode          Pointer    value;                                                                               1000434
    466+   End-PR;                                                                                                          1000435
    467+                                                                                                                    1000436
    468+   Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'jx_NodeSanitize');                                                   1000437
    469+     //node. Retrive from Locate()                                                                                  1000438
    470+     pRootNode      Pointer    value;                                                                               1000439
    471+   End-PR;                                                                                                          1000440
    472+                                                                                                                    1000441
    473+   //CheckSum of all names and values                                                                               1000442
    474+   //Delete all nodes which value are null                                                                          1000443
    475+   Dcl-PR json_NodeCheckSum Uns(10) extproc(*CWIDEN : 'jx_NodeCheckSum');                                           1000444
    476+     pRootNode      Pointer    value; //node. Retrive from Locate()                                                 1000445
    477+   End-PR;                                                                                                          1000446
    478+                                                                                                                    1000447
    479+   //returns the new node                                                                                           1000448
    480+   Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'jx_NewObject');                                                 1000449
    481+     //Destination. Retrive from Locate()                                                                           1000450
    482+     pDestNode      Pointer    value options(*nopass);                                                              1000451
    483+   End-PR;                                                                                                          1000452
    484+                                                                                                                    1000453
    485+ // Array functions                                                                                                 1000454
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    486+   //returns the new node                                                                                           1000455
    487+   Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'jx_NewArray');                                                   1000456
    488+     //Destination. Retrive from Locate()                                                                           1000457
    489+     pDestNode      Pointer    value options(*nopass);                                                              1000458
    490+   End-PR;                                                                                                          1000459
    491+                                                                                                                    1000460
    492+   //returns the new node added to the end of                                                                       1000461
    493+   Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'jx_ArrayPush');                                                 1000462
    494+     //Destination. Retrive from Locate()                                                                           1000463
    495+     pDestArray     Pointer    value;                                                                               1000464
    496+     //source node to append                                                                                        1000465
    497+     pSourceNode    Pointer    value options(*string);                                                              1000466
    498+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000467
    499+     copy           Uns(5)     value options(*nopass);                                                              1000468
    500+   End-PR;                                                                                                          1000469
    501+                                                                                                                    1000470
    502+   //Following constants used by json_ArrayPush:copy                                                                1000471
    503+   Dcl-C json_MOVE_UNLINK const(0);                                                                                 1000472
    504+   Dcl-C json_COPY_CLONE const(1);                                                                                  1000473
    505+                                                                                                                    1000474
    506+   //returns the new node added to the end of                                                                       1000475
    507+   Dcl-PR json_ArrayAppend Pointer extproc(*CWIDEN :'jx_ArrayAppend');                                              1000476
    508+     //Destination. Retrive from Locate()                                                                           1000477
    509+     pDestArray     Pointer    value;                                                                               1000478
    510+     //source node to append                                                                                        1000479
    511+     pSourceNode    Pointer    value options(*string);                                                              1000480
    512+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000481
    513+     copy           Uns(5)     value options(*nopass);                                                              1000482
    514+   End-PR;                                                                                                          1000483
    515+                                                                                                                    1000484
    516+   //returns the new array fro source array                                                                         1000485
    517+   Dcl-PR json_ArraySlice Pointer extproc(*CWIDEN : 'jx_ArraySlice' );                                              1000486
    518+     //source node or array string                                                                                  1000487
    519+     pSourceNode    Pointer    value options(*string);                                                              1000488
    520+     //From entry ( 1=First)                                                                                        1000489
    521+     from           Int(10)    value;                                                                               1000490
    522+     //To and includ   (-1 = Until end)                                                                             1000491
    523+     to             Int(10)    value;                                                                               1000492
    524+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000493
    525+     copy           Uns(5)     value options(*nopass);                                                              1000494
    526+   End-PR;                                                                                                          1000495
    527+                                                                                                                    1000496
    528+   //returns the new node added to the end of                                                                       1000497
    529+   Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'jx_ArraySort');                                                 1000498
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    530+     //Destination. Retrive from Locate()                                                                           1000499
    531+     pArray         Pointer    value;                                                                               1000500
    532+     //nodenames if any in subobject to comapre                                                                     1000501
    533+     pkeyNames      Pointer    value options(*string) ;                                                             1000502
    534+     //0=(Dft) use json numerics, 1=Use locale                                                                      1000503
    535+     options        uns(5)     value options(*nopass);                                                              1000504
    536+   End-PR;                                                                                                          1000505
    537+                                                                                                                    1000506
    538+   Dcl-C json_USE_LOCALE const(1);                                                                                  1000507
    539+                                                                                                                    1000508
    540+   //returns the first node with expr value                                                                         1000509
    541+   Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'jx_lookupValue');                                             1000510
    542+     //Array/ obj to search                                                                                         1000511
    543+     pArray         Pointer    value;                                                                               1000512
    544+     //What to search for                                                                                           1000513
    545+     expr           Pointer    value options(*string);                                                              1000514
    546+     //0=(Dft) Same case, 1=ignore case                                                                             1000515
    547+     ignoreCase     Uns(5)     value options(*nopass);                                                              1000516
    548+   End-PR;                                                                                                          1000517
    549+                                                                                                                    1000518
    550+   //Following constants used by json_LookupValue:ignoreCase                                                        1000519
    551+   Dcl-C json_SAME_CASE const(0);                                                                                   1000520
    552+   Dcl-C json_IGNORE_CASE const(1);                                                                                 1000521
    553+                                                                                                                    1000522
    554+   //returns numer of element in array or obj                                                                       1000523
    555+   Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'jx_getLength'  );                                               1000524
    556+     //Array to count length                                                                                        1000525
    557+     pArray         Pointer    value;                                                                               1000526
    558+   End-PR;                                                                                                          1000527
    559+                                                                                                                    1000528
    560+   //returns the new node                                                                                           1000529
    561+   Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'jx_NodeMerge');                                                     1000530
    562+     //Destination. Retrive from Locate()                                                                           1000531
    563+     pDestNode      Pointer    value;                                                                               1000532
    564+     //Source tree  Retrive from Locate()                                                                           1000533
    565+     pSourceNode    Pointer    value;                                                                               1000534
    566+     //Optional new type                                                                                            1000535
    567+     Type           Uns(5)     value options(*nopass);                                                              1000536
    568+   End-PR;                                                                                                          1000537
    569+                                                                                                                    1000538
    570+   //Following constants used by json_Merge:Type                                                                    1000539
    571+   Dcl-C json_DONTREPLACE const(0);                                                                                 1000540
    572+   Dcl-C json_REPLACE const(1);                                                                                     1000541
    573+                                                                                                                    1000542
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    574+   //returns the new node                                                                                           1000543
    575+   Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'jx_MergeObjects');                                           1000544
    576+     //Destination. Retrive from Locate()                                                                           1000545
    577+     pDestObj       Pointer    value;                                                                               1000546
    578+     //Source tree  Retrive from Locate()                                                                           1000547
    579+     pSourceObj     Pointer    value;                                                                               1000548
    580+     //JX_DONTREPLACE or json_OBJREPLACE                                                                            1000549
    581+     Type           Uns(5)     value;                                                                               1000550
    582+   End-PR;                                                                                                          1000551
    583+                                                                                                                    1000552
    584+   //returns the source node                                                                                        1000553
    585+   Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'jx_NodeMoveInto');                                         1000554
    586+     //Destination. Retrive from Locate()                                                                           1000555
    587+     pDestObj       Pointer    value;                                                                               1000556
    588+     Name           Pointer    value options(*string);                                                              1000557
    589+     //Source tree  Retrive from Locate()                                                                           1000558
    590+     pSourceObj     Pointer    value;                                                                               1000559
    591+   End-PR;                                                                                                          1000560
    592+                                                                                                                    1000561
    593+   Dcl-PR json_Dump  extproc(*CWIDEN : 'jx_Dump');                                                                  1000562
    594+     //Pointer to tree                                                                                              1000563
    595+     pNode          Pointer    value;                                                                               1000564
    596+   End-PR;                                                                                                          1000565
    597+                                                                                                                    1000566
    598+                                                                                                                    1000567
    599+   Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'jx_CloneFormat');                                                    1000568
    600+     //Pointer to tree to receive format                                                                            1000569
    601+     pNode          Pointer    value;                                                                               1000570
    602+     //node ptr or path with right formating                                                                        1000571
    603+     pCloneFrom     Pointer    value options(*string);                                                              1000572
    604+   End-PR;                                                                                                          1000573
    605+                                                                                                                    1000574
    606+   //**  JSON renderes ***                                                                                          1000575
    607+   Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                1000576
    608+     //node. Retrive from Locate()                                                                                  1000577
    609+     pNode          Pointer    value;                                                                               1000578
    610+     //Name of output stream file                                                                                   1000579
    611+     FileName       Pointer    value options(*string);                                                              1000580
    612+     //Ccsid of output file                                                                                         1000581
    613+     Ccsid          Int(10)    value;                                                                               1000582
    614+     Trim           Ind        value;                                                                               1000583
    615+     //Extra options                                                                                                1000584
    616+     Options        Pointer    value options(*string:*nopass);                                                      1000585
    617+   End-PR;                                                                                                          1000586
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    618+                                                                                                                    1000587
    619+   Dcl-PR json_AsJsonText Varchar(32767)                                                                            1000588
    620+                        extproc(*CWIDEN : 'jx_AsJsonText');                                                         1000589
    621+     //node. Retrive from Locate()                                                                                  1000590
    622+     pNode          Pointer    value;                                                                               1000591
    623+   End-PR;                                                                                                          1000592
    624+                                                                                                                    1000593
    625+   Dcl-PR json_AsJsonTextMem Uns(10)                                                                                1000594
    626+                           extproc(*CWIDEN : 'jx_AsJsonTextMem');                                                   1000595
    627+     //node. Retrive from Locate()                                                                                  1000596
    628+     pNode          Pointer    value;                                                                               1000597
    629+     //pointer to any memory buffer                                                                                 1000598
    630+     pBuffer        Pointer    value;                                                                               1000599
    631+     //Max number of bytes in buffer %size()                                                                        1000600
    632+     maxSize        Uns(10)    value options(*nopass);                                                              1000601
    633+   End-PR;                                                                                                          1000602
    634+                                                                                                                    1000603
    635+   //**  XML  renderes ***                                                                                          1000604
    636+   Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                  1000605
    637+     //node. Retrive from Locate()                                                                                  1000606
    638+     pNode          Pointer    value;                                                                               1000607
    639+     //Name of output stream file                                                                                   1000608
    640+     FileName       Pointer    value options(*string);                                                              1000609
    641+     //Ccsid of output file                                                                                         1000610
    642+     Ccsid          Int(10)    value;                                                                               1000611
    643+     Trim           Ind        value;                                                                               1000612
    644+     //Extra options                                                                                                1000613
    645+     Options        Pointer    value options(*string:*nopass);                                                      1000614
    646+   End-PR;                                                                                                          1000615
    647+                                                                                                                    1000616
    648+   Dcl-PR json_AsXmlText Varchar(32767) extproc(*CWIDEN : 'jx_AsXmlText');                                          1000617
    649+     //node. Retrive from Locate()                                                                                  1000618
    650+     pNode          Pointer    value;                                                                               1000619
    651+   End-PR;                                                                                                          1000620
    652+                                                                                                                    1000621
    653+   Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'jx_AsXmlTextMem');                                           1000622
    654+     //node. Retrive from Locate()                                                                                  1000623
    655+     pNode          Pointer    value;                                                                               1000624
    656+     //pointer to any memory buffer                                                                                 1000625
    657+     pBuffer        Pointer    value;                                                                               1000626
    658+   End-PR;                                                                                                          1000627
    659+                                                                                                                    1000628
    660+   // Return a streamer object to be used in own serialisers                                                        1000629
    661+   Dcl-PR json_Stream pointer extproc(*CWIDEN : 'jx_Stream');                                                       1000630
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    662+     //node. Retrive from Locate()                                                                                  1000631
    663+     pNode          Pointer    value;                                                                               1000632
    664+   End-PR;                                                                                                          1000633
    665+                                                                                                                    1000634
    666+   //**  CSV  renderes ***                                                                                          1000635
    667+   Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'jx_WriteCsvStmf');                                                  1000636
    668+     //node. Retrive from Locate()                                                                                  1000637
    669+     pNode          Pointer    value;                                                                               1000638
    670+     //Name of output stream file                                                                                   1000639
    671+     FileName       Pointer    value options(*string);                                                              1000640
    672+     //Ccsid of output file                                                                                         1000641
    673+     Ccsid          Int(10)    value;                                                                               1000642
    674+     //*ON=Remove inter blanks                                                                                      1000643
    675+     Trim           Ind        value;                                                                               1000644
    676+     //Options: ';.' for separator and dec                                                                          1000645
    677+     Options        Pointer    value options(*string:*nopass);                                                      1000646
    678+   End-PR;                                                                                                          1000647
    679+                                                                                                                    1000648
    680+                                                                                                                    1000649
    681+   Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                        1000650
    682+     Slash          Char(1);                                                                                        1000651
    683+     BackSlash      Char(1);                                                                                        1000652
    684+     Masterspace    Char(1);                                                                                        1000653
    685+     BraBeg         Char(1);                                                                                        1000654
    686+     BraEnd         Char(1);                                                                                        1000655
    687+     Blank          Char(1);                                                                                        1000656
    688+     Dot            Char(1);                                                                                        1000657
    689+     CurBeg         Char(1);                                                                                        1000658
    690+     CurEnd         Char(1);                                                                                        1000659
    691+     Apos           Char(1);                                                                                        1000660
    692+     Quot           Char(1);                                                                                        1000661
    693+   End-DS;                                                                                                          1000662
    694+                                                                                                                    1000663
    695+   //Iterators: First use the set the use forEach                                                                   1000664
    696+   Dcl-DS json_Iterator  based(prototype_only) qualified;                                                           1000665
    697+     root           Pointer;                                                                                        1000666
    698+     this           Pointer;                                                                                        1000667
    699+     isList         Ind;                                                                                            1000668
    700+     isFirst        Ind;                                                                                            1000669
    701+     isLast         Ind;                                                                                            1000670
    702+     isRecursive    Ind;                                                                                            1000671
    703+     comma          Varchar(1);                                                                                     1000672
    704+     count          Int(10);                                                                                        1000673
    705+     length         Int(10);                                                                                        1000674
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    706+     size           Int(10);                                                                                        1000675
    707+     //Pointer to temp array of elms                                                                                1000676
    708+     listArr        Pointer;                                                                                        1000677
    709+     //Set  this to *ON to teminate loop                                                                            1000678
    710+     break          Ind;                                                                                            1000679
    711+     filler         Char(64);                                                                                       1000680
    712+   End-DS;                                                                                                          1000681
    713+                                                                                                                    1000682
    714+   Dcl-PR json_setIterator  likeds( json_Iterator)                                                                  1000683
    715+                          extproc(*CWIDEN : 'jx_SetIterator');                                                      1000684
    716+     //node. Retrive from Locate()                                                                                  1000685
    717+     pNode          Pointer    value;                                                                               1000686
    718+     //Optional - path to node                                                                                      1000687
    719+     path           Pointer    value options(*string:*nopass);                                                      1000688
    720+   End-PR;                                                                                                          1000689
    721+                                                                                                                    1000690
    722+   Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                         1000691
    723+                                   extproc(*CWIDEN :                                                                1000692
    724+                                   'jx_SetRecursiveIterator');                                                      1000693
    725+     //node. Retrive from Locate()                                                                                  1000694
    726+     pNode          Pointer    value;                                                                               1000695
    727+     //Optional - path to node                                                                                      1000696
    728+     path           Pointer    value options(*string:*nopass);                                                      1000697
    729+   End-PR;                                                                                                          1000698
    730+                                                                                                                    1000699
    731+   //Iterator Structure                                                                                             1000700
    732+   Dcl-PR json_forEach Ind extproc(*CWIDEN : 'jx_ForEach');                                                         1000701
    733+     iterator                  likeds( json_Iterator);                                                              1000702
    734+   End-PR;                                                                                                          1000703
    735+                                                                                                                    1000704
    736+   //For XML attributes                                                                                             1000705
    737+   Dcl-PR json_GetNodeAttrValue Varchar(32767)                                                                      1000706
    738+                              extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                           1000707
    739+     //Pointer to exsiting element                                                                                  1000708
    740+     pNode          Pointer    value;                                                                               1000709
    741+     //Attribute Name                                                                                               1000710
    742+     AttrName       Pointer    value options(*string);                                                              1000711
    743+     //If not found - default value                                                                                 1000712
    744+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000713
    745+   End-PR;                                                                                                          1000714
    746+                                                                                                                    1000715
    747+   Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'jx_SetNodeAttrValue');                                           1000716
    748+     //Pointer to exsiting element                                                                                  1000717
    749+     pNode          Pointer    value;                                                                               1000718
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    750+     //Attribute name                                                                                               1000719
    751+     AttrName       Pointer    value options(*string);                                                              1000720
    752+     //New value                                                                                                    1000721
    753+     Value          Pointer    value options(*string);                                                              1000722
    754+   End-PR;                                                                                                          1000723
    755+                                                                                                                    1000724
    756+   Dcl-PR json_GetAttrValue Varchar(32767)                                                                          1000725
    757+                          extproc(*CWIDEN : 'jx_GetAttrValueVC');                                                   1000726
    758+     //Pointer Attribute                                                                                            1000727
    759+     pAttr          Pointer    value;                                                                               1000728
    760+     //If not found - default value                                                                                 1000729
    761+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000730
    762+   End-PR;                                                                                                          1000731
    763+                                                                                                                    1000732
    764+   Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'jx_SetAttrValue');                                                   1000733
    765+     //Pointer Attribute                                                                                            1000734
    766+     pAttr          Pointer    value;                                                                               1000735
    767+     //New value                                                                                                    1000736
    768+     AttrName       Pointer    value options(*string);                                                              1000737
    769+     //Default value                                                                                                1000738
    770+     Value          Pointer    value options(*string);                                                              1000739
    771+   End-PR;                                                                                                          1000740
    772+                                                                                                                    1000741
    773+   //Returns pointer to attribute list                                                                              1000742
    774+   Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'jx_GetAttrFirst');                                           1000743
    775+     //Pointer to element                                                                                           1000744
    776+     pElem          Pointer    value;                                                                               1000745
    777+   End-PR;                                                                                                          1000746
    778+                                                                                                                    1000747
    779+   //Returns pointer to attribute list                                                                              1000748
    780+   Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'jx_GetAttrNext');                                             1000749
    781+     //Pointer to attribute list                                                                                    1000750
    782+     pAttr          Pointer    value;                                                                               1000751
    783+   End-PR;                                                                                                          1000752
    784+                                                                                                                    1000753
    785+   Dcl-PR json_GetAttrName Varchar(32767)                                                                           1000754
    786+                         extproc(*CWIDEN : 'jx_GetAttrNameVC');                                                     1000755
    787+     //Pointer to attribute list                                                                                    1000756
    788+     pAttr          Pointer    value;                                                                               1000757
    789+   End-PR;                                                                                                          1000758
    790+                                                                                                                    1000759
    791+ // Clear the contents of an array or object / delete all children                                                  1000760
    792+   Dcl-PR json_Clear  extproc(*CWIDEN : 'jx_Clear');                                                                1000761
    793+     pNode          Pointer    value; //Pointer to tree node                                                        1000762
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    794+   End-PR;                                                                                                          1000763
    795+                                                                                                                    1000764
    796+ // Close all nodes in this tree - also parent and siblings                                                         1000765
    797+   Dcl-PR json_Close  extproc(*CWIDEN : 'jx_Close');                                                                1000766
    798+     //Pointer to tree node                                                                                         1000767
    799+     pNode          Pointer  ;                                                                                      1000768
    800+   End-PR;                                                                                                          1000769
    801+ // Detect if you have a memry leak: call this when you have closed everything at i will return                     1000770
    802+   Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'jx_MemLeak');                                                         1000771
    803+   End-PR;                                                                                                          1000772
    804+                                                                                                                    1000773
    805+ // Print memory report                                                                                             1000774
    806+   Dcl-PR json_MemStat  extproc(*CWIDEN : 'jx_MemStat');                                                            1000775
    807+   End-PR;                                                                                                          1000776
    808+                                                                                                                    1000777
    809+ // retune number of bytest used                                                                                    1000778
    810+   Dcl-PR json_MemUse Uns(20) extproc(*CWIDEN : 'jx_MemUse');                                                       1000779
    811+   End-PR;                                                                                                          1000780
    812+                                                                                                                    1000781
    813+ // Return a memory segment pointer, and build a scope where JSON/XML will be created                               1000782
    814+   Dcl-PR json_SegmentSelectNo Pointer                                                                              1000783
    815+                             extproc(*CWIDEN : 'jx_SegmentSelectNo');                                               1000784
    816+     SegmentIndex   Int(10)    value;                                                                               1000785
    817+   End-PR;                                                                                                          1000786
    818+                                                                                                                    1000787
    819+ //  Delete the segment and all JSON/XML nodes build while segment scope was active                                 1000788
    820+   Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'jx_SegmentDispose');                                              1000789
    821+     segmentPtr     Pointer    value;                                                                               1000790
    822+   End-PR;                                                                                                          1000791
    823+                                                                                                                    1000792
    824+ // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                     1000793
    825+   //Returns *ON if found                                                                                           1000794
    826+   Dcl-PR json_mapIx Ind extproc(*CWIDEN:'jx_MapIx' );                                                              1000795
    827+     //pointer to node pointer                                                                                      1000796
    828+     ppNode         Pointer;                                                                                        1000797
    829+     //index of pointer                                                                                             1000798
    830+     Index          Uns(10)    value;                                                                               1000799
    831+   End-PR;                                                                                                          1000800
    832+                                                                                                                    1000801
    833+   //------------------------------------------------------------------------                                       1000802
    834+   //SQL interface:                                                                                                 1000803
    835+   //Note: When SQL functions returns *NULL, then use  the json_Message() to re                                     1000804
    836+   //------------------------------------------------------------------------                                       1000805
    837+                                                                                                                    1000806
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    838+ // If options need - then it has to be first call made.                                                            1000807
    839+ // NOTE: If a pConnection pointer is provided, it will be updated with the conection                               1000808
    840+   Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'jx_sqlSetOptions');                                                 1000809
    841+     //json object with options ( see sample)                                                                       1000810
    842+     parms          Pointer    value options(*string:*nopass);                                                      1000811
    843+   End-PR;                                                                                                          1000812
    844+                                                                                                                    1000813
    845+ // returns a object node with one resulting row for the SQL statment                                               1000814
    846+   //Returns one SQL row as jx Obejct                                                                               1000815
    847+   Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'jx_sqlResultRow');                                            1000816
    848+     //SQL statement to run                                                                                         1000817
    849+     sqlStmt        Pointer    value options(*string);                                                              1000818
    850+     //json object template                                                                                         1000819
    851+     parms          Pointer    value options(*string:*nopass);                                                      1000820
    852+   End-PR;                                                                                                          1000821
    853+                                                                                                                    1000822
    854+ // returns an array (or object with array) of resulting rows for the SQL statment                                  1000823
    855+   //Returns SQL rows as jx Obejct                                                                                  1000824
    856+   Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'jx_sqlResultSet');                                            1000825
    857+     //SQL statement to run                                                                                         1000826
    858+     sqlStmt        Pointer    value options(*string);                                                              1000827
    859+     //From row; 1=First                                                                                            1000828
    860+     start          Int(10)    value options(*nopass);                                                              1000829
    861+     //max number of rows; json_ALLROWS=all                                                                         1000830
    862+     limit          Int(10)    value options(*nopass);                                                              1000831
    863+     //resultset format:                                                                                            1000832
    864+     format         Int(10)    value options(*nopass);                                                              1000833
    865+     //json object template                                                                                         1000834
    866+     parms          Pointer    value options(*string:*nopass);                                                      1000835
    867+   End-PR;                                                                                                          1000836
    868+                                                                                                                    1000837
    869+                                                                                                                    1000838
    870+   Dcl-C json_ALLROWS const(-1);                                                                                    1000839
    871+                                                                                                                    1000840
    872+   //Following constants used by json_sqlResultSet:format                                                           1000841
    873+   //+ An array with each row as an object                                                                          1000842
    874+   Dcl-C json_ROWARRAY const(0);                                                                                    1000843
    875+   //+ Metaobject: rows, fields                                                                                     1000844
    876+   Dcl-C json_META    const(1);                                                                                     1000845
    877+   //+ Columns info                                                                                                 1000846
    878+   Dcl-C json_FIELDS  const(2);                                                                                     1000847
    879+   //+ Count all rows in the resultset                                                                              1000848
    880+   // ( Pricy so awoid it !! )                                                                                      1000849
    881+   Dcl-C json_TOTALROWS const(4);                                                                                   1000850
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    882+   //+ Uppercase column names                                                                                       1000851
    883+   Dcl-C json_UPPERCASE const(8);                                                                                   1000852
    884+                                                                                                                    1000853
    885+   //+ Appoximate number of rows..                                                                                  1000854
    886+   //  ( unpresise but cheap !! prefered  )                                                                         1000855
    887+   Dcl-C json_APPROXIMATE_TOTALROWS const(16);                                                                      1000856
    888+                                                                                                                    1000857
    889+                                                                                                                    1000858
    890+                                                                                                                    1000859
    891+ // SQL cursor processing                                                                                           1000860
    892+   //Returns handle to sql statement                                                                                1000861
    893+   Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'jx_sqlOpen'  );                                                     1000862
    894+     //SQL statement to run                                                                                         1000863
    895+     sqlStmt        Pointer    value options(*string);                                                              1000864
    896+     //json object template                                                                                         1000865
    897+     parms          Pointer    value options(*string:*nopass);                                                      1000866
    898+   End-PR;                                                                                                          1000867
    899+                                                                                                                    1000868
    900+ // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                                  1000869
    901+   //Returns a row object (or *NULL if EOF)                                                                         1000870
    902+   Dcl-PR json_sqlFetchRelative Pointer                                                                             1000871
    903+                              extproc(*CWIDEN: 'jx_sqlFetchRelative');                                              1000872
    904+     //sql statement handle ( from sqlOpen)                                                                         1000873
    905+     pSqlHndl       Pointer    value;                                                                               1000874
    906+     //row from where to start 1=First                                                                              1000875
    907+     fromRow        Int(10)    value;                                                                               1000876
    908+   End-PR;                                                                                                          1000877
    909+                                                                                                                    1000878
    910+ // Fetch next from from that open sql handle                                                                       1000879
    911+   //Returns a row object (or *NULL if EOF)                                                                         1000880
    912+   Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'jx_sqlFetchNext');                                             1000881
    913+     //sql statement handle ( from sqlOpen)                                                                         1000882
    914+     pSqlHndl       Pointer    value;                                                                               1000883
    915+   End-PR;                                                                                                          1000884
    916+                                                                                                                    1000885
    917+ // Number of columns in result set ( -1 if error)                                                                  1000886
    918+   //Returns number of columns                                                                                      1000887
    919+   Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'jx_sqlColumns');                                                 1000888
    920+     //sql statement handle ( from sqlOpen)                                                                         1000889
    921+     pSqlHndl       Pointer    value;                                                                               1000890
    922+   End-PR;                                                                                                          1000891
    923+                                                                                                                    1000892
    924+ // Number of rows  in result set ( -1 if error)                                                                    1000893
    925+ // Note: This will run a hidden "select count(*)" which might be a little pricy                                    1000894
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    926+   //Returns number of rows                                                                                         1000895
    927+   Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'jx_sqlRows');                                                       1000896
    928+     //sql statement handle ( from sqlOpen)                                                                         1000897
    929+     pSqlHndl       Pointer    value;                                                                               1000898
    930+   End-PR;                                                                                                          1000899
    931+                                                                                                                    1000900
    932+ // Always colse the cursor after use, to release resources                                                         1000901
    933+   Dcl-PR json_sqlClose  extproc(*CWIDEN:'jx_sqlClose');                                                            1000902
    934+     //sql statement handle ( from sqlOpen)                                                                         1000903
    935+     pSqlHndl       Pointer;                                                                                        1000904
    936+   End-PR;                                                                                                          1000905
    937+                                                                                                                    1000906
    938+ // Execute any SQL statement not involving a cursor                                                                1000907
    939+   //Returns *ON if error                                                                                           1000908
    940+   Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'jx_sqlExec'  );                                                         1000909
    941+     //SQL statement to run (template)                                                                              1000910
    942+     sqlStmt        Pointer    value options(*string);                                                              1000911
    943+     //json object template data                                                                                    1000912
    944+     parms          Pointer    value options(*string:*nopass);                                                      1000913
    945+   End-PR;                                                                                                          1000914
    946+                                                                                                                    1000915
    947+ // Execute an update table where the row is defined as a json object                                               1000916
    948+   //Returns *ON if error                                                                                           1000917
    949+   Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'jx_sqlUpdate');                                                       1000918
    950+     //table name                                                                                                   1000919
    951+     table          Pointer    value options(*string);                                                              1000920
    952+     //json object: æa:123,b:"value"å                                                                               1000921
    953+     row            Pointer    value options(*string);                                                              1000922
    954+     //where clause : 'where myKey=Åkey'                                                                            1000923
    955+     where          Pointer    value options(*string:*nopass);                                                      1000924
    956+     //where parameters: æ key:777å                                                                                 1000925
    957+     whereParms     Pointer    value options(*string:*nopass);                                                      1000926
    958+   End-PR;                                                                                                          1000927
    959+                                                                                                                    1000928
    960+   //Returns *ON if error                                                                                           1000929
    961+   Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'jx_sqlInsert');                                                       1000930
    962+     //table name                                                                                                   1000931
    963+     table          Pointer    value options(*string);                                                              1000932
    964+     //json object: æa:123,b:"value"å                                                                               1000933
    965+     row            Pointer    value options(*string);                                                              1000934
    966+     //extra parms                                                                                                  1000935
    967+     parms          Pointer    value options(*string:*nopass);                                                      1000936
    968+   End-PR;                                                                                                          1000937
    969+                                                                                                                    1000938
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    970+   //Returns *ON if error                                                                                           1000939
    971+   Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'jx_sqlUpsert');                                                       1000940
    972+     //table name                                                                                                   1000941
    973+     table          Pointer    value options(*string);                                                              1000942
    974+     //json object: æa:123,b:"value"å                                                                               1000943
    975+     row            Pointer    value options(*string);                                                              1000944
    976+     //where clause : 'where myKey=Åkey'                                                                            1000945
    977+     where          Pointer    value options(*string:*nopass);                                                      1000946
    978+     //where parameters: æ key:777å                                                                                 1000947
    979+     whereParms     Pointer    value options(*string:*nopass);                                                      1000948
    980+   End-PR;                                                                                                          1000949
    981+                                                                                                                    1000950
    982+   //Returns id of last insert                                                                                      1000951
    983+   Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'jx_sqlGetInsertId');                                         1000952
    984+   End-PR;                                                                                                          1000953
    985+                                                                                                                    1000954
    986+   //Returns array of column info                                                                                   1000955
    987+   Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'jx_sqlGetMeta');                                                 1000956
    988+     sqlstmt        Pointer    value options(*string);                                                              1000957
    989+   End-PR;                                                                                                          1000958
    990+                                                                                                                    1000959
    991+ // Return pointer to database connection. No options => will be default local database                             1000960
    992+   Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'jx_sqlConnect');                                                1000961
    993+     //json object or string with options                                                                           1000962
    994+     parms          Pointer    value options(*string:*nopass);                                                      1000963
    995+   End-PR;                                                                                                          1000964
    996+                                                                                                                    1000965
    997+ // Return pointer to database connection. No options => will be default local database                             1000966
    998+   Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'jx_sqlDisconnect');                                                 1000967
    999+   End-PR;                                                                                                          1000968
   1000+                                                                                                                    1000969
   1001+ // Return sql code for previous statement                                                                          1000970
   1002+   Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'jx_sqlCode');                                                      1000971
   1003+   End-PR;                                                                                                          1000972
   1004+                                                                                                                    1000973
   1005+ //Returns a JSON object from a REST call                                                                           1000974
   1006+   Dcl-PR json_httpRequest Pointer extproc(*CWIDEN:'jx_httpRequest');                                               1000975
   1007+     //Full URL to the resource                                                                                     1000976
   1008+     url            Pointer    value options(*string);                                                              1000977
   1009+     //json object or string                                                                                        1000978
   1010+     pReqNode       Pointer    value options(*string:*nopass);                                                      1000979
   1011+     //extra CURL options                                                                                           1000980
   1012+     options        Pointer    value options(*string:*nopass);                                                      1000981
   1013+   End-PR;                                                                                                          1000982
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1014+                                                                                                                    1000983
   1015+ // when the dataarea SQLTRACE is set, your SQL statements                                                          1000984
   1016+ // are logged into SQLTRACE table.                                                                                 1000985
   1017+ // you can supply an extr eye-catch wariable :trcid                                                                1000986
   1018+   Dcl-PR json_traceSetId  extproc(*CWIDEN : 'jx_traceSetId');                                                      1000987
   1019+     traceId        Int(20)    value; //Ccsid of inpur file                                                         1000988
   1020+   End-PR;                                                                                                          1000989
   1021+                                                                                                                    1000990
   1022+ // -------------------------------------------------------------------------------------------                     1000991
   1023+ // Depricated and renamed functions :                                                                              1000992
   1024+ // -------------------------------------------------------------------------------------------                     1000993
   1025+ // Depricated - use  json_GetValueStr                                                                              1000994
   1026+   Dcl-PR json_GetValue Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                          1000995
   1027+     //Pointer to node                                                                                              1000996
   1028+     pNode          Pointer    value;                                                                               1000997
   1029+     //If not found - default value                                                                                 1000998
   1030+     Expression     Pointer    value options(*string:*nopass);                                                      1000999
   1031+     //If not found - default value                                                                                 1001000
   1032+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001001
   1033+   End-PR;                                                                                                          1001002
   1034+                                                                                                                    1001003
   1035+ // Depricated - use  json_NodeCopy                                                                                 1001004
   1036+   Dcl-PR json_Copy extproc(*CWIDEN : 'jx_NodeCopy');                                                               1001005
   1037+     //element. Retrive from Locate()                                                                               1001006
   1038+     pRootNode      Pointer    value;                                                                               1001007
   1039+     //element. Retrive from Locate()                                                                               1001008
   1040+     pNewChild      Pointer    value;                                                                               1001009
   1041+     //Reference location to where it arrive                                                                        1001010
   1042+     RefLocation    Int(10)    value;                                                                               1001011
   1043+   End-PR;                                                                                                          1001012
   1044+                                                                                                                    1001013
   1045+   Dcl-PR json_ElementCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                        1001014
   1046+     //element. Retrive from Locate()                                                                               1001015
   1047+     pRootNode      Pointer    value;                                                                               1001016
   1048+     //element. Retrive from Locate()                                                                               1001017
   1049+     pNewChild      Pointer    value;                                                                               1001018
   1050+     //Reference location to where it arrive                                                                        1001019
   1051+     RefLocation    Int(10)    value;                                                                               1001020
   1052+   End-PR;                                                                                                          1001021
   1053+                                                                                                                    1001022
   1054+ // Depricated - use  json_NodeDelete                                                                               1001023
   1055+   Dcl-PR json_Delete extproc(*CWIDEN : 'jx_NodeDelete');                                                           1001024
   1056+     //element. Retrive from Locate()                                                                               1001025
   1057+     pRootNode      Pointer    value;                                                                               1001026
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1058+   End-PR;                                                                                                          1001027
   1059+                                                                                                                    1001028
   1060+ // Depricated - use  json_NodeDelete                                                                               1001029
   1061+   Dcl-PR json_ElementDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                    1001030
   1062+     //element. Retrive from Locate()                                                                               1001031
   1063+     pRootNode      Pointer    value;                                                                               1001032
   1064+   End-PR;                                                                                                          1001033
   1065+                                                                                                                    1001034
   1066+ // Depricated - use  json_AsJsonText                                                                               1001035
   1067+   Dcl-PR json_AsText Varchar(32767) extproc(*CWIDEN : 'jx_AsJsonText');                                            1001036
   1068+     //element. Retrive from Locate()                                                                               1001037
   1069+     pNode          Pointer    value;                                                                               1001038
   1070+   End-PR;                                                                                                          1001039
   1071+                                                                                                                    1001040
   1072+                                                                                                                    1001041
   1073+ // json_XpathValue   is depricated and replaced by: json_GetStr                                                    1001042
   1074+   Dcl-PR json_XpathValue Varchar(32767)                                                                            1001043
   1075+                        extproc(*CWIDEN : 'jx_GetValueVC');                                                         1001044
   1076+     //Pointer to tree                                                                                              1001045
   1077+     pNode          Pointer    value;                                                                               1001046
   1078+     //Locations expression to node                                                                                 1001047
   1079+     Expression     Pointer    value options(*string);                                                              1001048
   1080+     //If not found - default value                                                                                 1001049
   1081+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001050
   1082+   End-PR;                                                                                                          1001051
   1083+                                                                                                                    1001052
   1084+ // json_XpathValueNum   is depricated and replaced by: json_GetNum                                                 1001053
   1085+   Dcl-PR json_XpathValueNum Packed(30:15)                                                                          1001054
   1086+                           extproc(*CWIDEN : 'jx_GetValueNum');                                                     1001055
   1087+     //Pointer to tree                                                                                              1001056
   1088+     pJsonCom       Pointer    value;                                                                               1001057
   1089+     //X-path locations to node or attributes                                                                       1001058
   1090+     Node           Pointer    value options(*string);                                                              1001059
   1091+     //If not found - default value                                                                                 1001060
   1092+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1001061
   1093+   End-PR;                                                                                                          1001062
   1094+                                                                                                                    1001063
   1095+ // Use - json_NodeType                                                                                             1001064
   1096+   Dcl-PR json_ElementType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                              1001065
   1097+     //Pointer to tree to receive format                                                                            1001066
   1098+     pNode          Pointer    value;                                                                               1001067
   1099+   End-PR;                                                                                                          1001068
   1100+                                                                                                                    1001069
   1101+ // Use json_NodeAdd                                                                                                1001070
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1102+   //returns the new element                                                                                        1001071
   1103+   Dcl-PR json_ElementAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                  1001072
   1104+     //element. Retrive from Locate()                                                                               1001073
   1105+     pRootNode      Pointer    value;                                                                               1001074
   1106+     //Reference location to where it arrive                                                                        1001075
   1107+     RefLocation    Int(10)    value;                                                                               1001076
   1108+     //Name of element                                                                                              1001077
   1109+     Name           Pointer    value options(*string);                                                              1001078
   1110+     //Value of element                                                                                             1001079
   1111+     Value          Pointer    value options(*string);                                                              1001080
   1112+   End-PR;                                                                                                          1001081
   1113+                                                                                                                    1001082
   1114+ // Use json_GetNext                                                                                                1001083
   1115+   //Returns pointer to next sibling (elem)                                                                         1001084
   1116+   Dcl-PR json_GetElemNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                             1001085
   1117+     //Pointer to current element (elem)                                                                            1001086
   1118+     pElem          Pointer    value  ;                                                                             1001087
   1119+   End-PR;                                                                                                          1001088
   1120+                                                                                                                    1001089
   1121+ // use json_GetChild                                                                                               1001090
   1122+   //Returns pointer to next child (elem)                                                                           1001091
   1123+   Dcl-PR json_GetElemChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                           1001092
   1124+     //Pointer to current element (elem)                                                                            1001093
   1125+     pElem          Pointer    value;                                                                               1001094
   1126+   End-PR;                                                                                                          1001095
   1127+                                                                                                                    1001096
   1128+                                                                                                                    1001097
   1129+ // use get json_GetName                                                                                            1001098
   1130+   Dcl-PR json_getElemName Varchar(32767)                                                                           1001099
   1131+                         extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                     1001100
   1132+     //Pointer to node                                                                                              1001101
   1133+     pNode          Pointer    value;                                                                               1001102
   1134+   End-PR;                                                                                                          1001103
   1135+                                                                                                                    1001104
   1136+ // use xml_GetValueStr                                                                                             1001105
   1137+   Dcl-PR json_GetElemValue Varchar(32767)                                                                          1001106
   1138+                          extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                   1001107
   1139+     //Pointer to element                                                                                           1001108
   1140+     pElem          Pointer    value;                                                                               1001109
   1141+     //If not found - default value                                                                                 1001110
   1142+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001111
   1143+   End-PR;                                                                                                          1001112
   1144+                                                                                                                    1001113
   1145+  // use json_GetAttrValue                                                                                          1001114
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1146+   Dcl-PR json_GetAttr Varchar(32767)                                                                               1001115
   1147+                     extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                                    1001116
   1148+     //Pointer to element                                                                                           1001117
   1149+     pNode          Pointer    value;                                                                               1001118
   1150+     //Attribute Name                                                                                               1001119
   1151+     AttrName       Pointer    value options(*string);                                                              1001120
   1152+     //If not found - default value                                                                                 1001121
   1153+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001122
   1154+   End-PR;                                                                                                          1001123
   1155+                                                                                                                    1001124
   1156+ // has no effect any longer                                                                                        1001125
   1157+   //Set input and output CCSID                                                                                     1001126
   1158+   Dcl-PR json_setCcsid  extproc(*CWIDEN : 'jx_SetCcsid');                                                          1001127
   1159+     //Ccsid of inpur file                                                                                          1001128
   1160+     inputCCSID     Int(10)    value;                                                                               1001129
   1161+     //Ccsid of output file                                                                                         1001130
   1162+     outputCCSID    Int(10)    value;                                                                               1001131
   1163+   End-PR;                                                                                                          1001132
   1164+                                                                                                                    1001133
   1165+ // depricated - use setNum                                                                                         1001134
   1166+   Dcl-PR json_SetDec Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1001135
   1167+     //Pointer to json_ tree                                                                                        1001136
   1168+     pNode          Pointer    value;                                                                               1001137
   1169+     //X-path locations to node or attributes                                                                       1001138
   1170+     Expresion      Pointer    value options(*string);                                                              1001139
   1171+     //New value to set / pointer to object                                                                         1001140
   1172+     Value          Packed(30:15) value;                                                                            1001141
   1173+   End-PR;                                                                                                          1001142
   1174+                                                                                                                    1001143
   1175+ // Depricated in both JSON and XML - use  json_WriteJsonStmf /   json_WriteXmlStmf                                 1001144
   1176+ /if not defined(JSONXML_DEPRICATED)                                                                                1001145
   1177+ /define  JSONXML_DEPRICATED                                                                                        1001146
   1178+   Dcl-PR json_WriteStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                    1001147
   1179+     //element. Retrive from Locate()                                                                               1001148
   1180+     pNode          Pointer    value;                                                                               1001149
   1181+     //Name of output stream file                                                                                   1001150
   1182+     FileName       Pointer    value options(*string);                                                              1001151
   1183+     //Ccsid of output file                                                                                         1001152
   1184+     Ccsid          Int(10)    value;                                                                               1001153
   1185+     Trim           Ind        value options(*nopass);                                                              1001154
   1186+   End-PR;                                                                                                          1001155
   1187+                                                                                                                    1001156
   1188+   Dcl-PR xml_WriteStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                      1001157
   1189+     //element. Retrive from Locate()                                                                               1001158
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1190+     pNode          Pointer    value;                                                                               1001159
   1191+     //Name of output stream file                                                                                   1001160
   1192+     FileName       Pointer    value options(*string);                                                              1001161
   1193+     //Ccsid of output file                                                                                         1001162
   1194+     Ccsid          Int(10)    value;                                                                               1001163
   1195+     Trim           Ind        value options(*nopass);                                                              1001164
   1196+   End-PR;                                                                                                          1001165
   1197+ /endif                                                                                                             1001166
   1198    Dcl-S pRows        Pointer;                                                                                       000033
   1199    Dcl-S sql          Varchar(512);                                                                                  000034
   1200    Dcl-S start        Int(10);                                                                                       000035
   1201    Dcl-S limit        Int(10);                                                                                       000036
   1202                                                                                                                      000037
   1203    //------------------------------------------------------------- *                                                 000038
   1204                                                                                                                      000039
   1205    // return a object with all rows                                                                                  000040
   1206    sql   = ('-                                                                                                       000041
   1207          call qgpl.custList (custName => ''john'' ) -                                                                000042
   1208    ');                                                                                                               000043
   1209                                                                                                                      000044
   1210    start = 1;                                                                                                        000045
   1211    limit = JSON_ALLROWS;                                                                                             000046
   1212    pRows = json_sqlResultSet(                                                                                        000047
   1213        sql:                                                                                                          000048
   1214        start:                                                                                                        000049
   1215        limit:                                                                                                        000050
   1216        JSON_META+JSON_FIELDS                                                                                         000051
   1217    );                                                                                                                000052
   1218                                                                                                                      000053
   1219    // Produce a JSON stream file in the root of the IFS                                                              000054
   1220    json_writeJsonStmf(pRows  :                                                                                       000055
   1221       '/jsonxml/json/resultset-object-1.json' : 1208 : *ON                                                           000056
   1222    );                                                                                                                000057
   1223                                                                                                                      000058
   1224    // Cleanup: Close the SQL cursor, dispose the rows, arrays and disconnect                                         000059
   1225    json_close(pRows);                                                                                                000060
   1226    json_sqlDisconnect();                                                                                             000061
   1227                                                                                                                      000062
   1228    // That's it..                                                                                                    000063
   1229    *inlr = *on;                                                                                                      000064
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     31
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     32
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv Number Seq     Message text
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                             / C o p y   M e m b e r s
 Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
 Number Id              Library    File       Member            Date     Time
     32    1 JSONPARSE+ ./../headers/JSONPARSER.rpgle     1252  17-07-19 15:16:36
          * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     33
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          No references in the source.
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                 1229M
          JSON_AFTER_SIBLING...
                            CONST                 436D
          JSON_ALLOW_PRIMITIVES...
                            CONST                  92D
          JSON_ALLROWS      CONST                 870D   1211
          JSON_APPROXIMATE_TOTALROWS...
                            CONST                 887D
          JSON_ARRAY        CONST                  75D
 *RNF7031 JSON_ARRAYAPPEND  *(16)                 507D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYPUSH    *(16)                 493D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSLICE   *(16)                 517D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSORT    *(16)                 529D
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXT   A(32767)              619D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXTMEM...
                            U(10,0)               625D
                            PROTOTYPE
 *RNF7031 JSON_ASTEXT       A(32767)             1067D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXT    A(32767)              648D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXTMEM U(10,0)               653D
                            PROTOTYPE
          JSON_BEFORE_SIBLING...
                            CONST                 435D
          JSON_BY_CONTEXT   CONST                  84D
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     34
          JSON_CHILD_LIST   CONST                 112D
 *RNF7031 JSON_CLEAR        PROTOTYPE             792D
 *RNF7031 JSON_CLONEFORMAT  PROTOTYPE             599D
          JSON_CLOSE        PROTOTYPE             797D   1225M
 *RNF7031 JSON_COPY         PROTOTYPE            1036D
          JSON_COPY_CLONE   CONST                 504D
 *RNF7031 JSON_COPYVALUE    *(16)                 412D
                            PROTOTYPE
 *RNF7031 JSON_DELETE       PROTOTYPE            1055D
 *RNF7031 JSON_DELIMITERDS  DS(11)                681D
                            BASED(PROTOTYPE+)
 *RNF7031   APOS            A(1)                  691D
 *RNF7031   BACKSLASH       A(1)                  683D
 *RNF7031   BLANK           A(1)                  687D
 *RNF7031   BRABEG          A(1)                  685D
 *RNF7031   BRAEND          A(1)                  686D
 *RNF7031   CURBEG          A(1)                  689D
 *RNF7031   CUREND          A(1)                  690D
 *RNF7031   DOT             A(1)                  688D
 *RNF7031   MASTERSPACE     A(1)                  684D
 *RNF7031   QUOT            A(1)                  692D
 *RNF7031   SLASH           A(1)                  682D
          JSON_DELIMITERS   CONST                  68D
          JSON_DONTREPLACE  CONST                 571D
 *RNF7031 JSON_DUMP         PROTOTYPE             593D
 *RNF7031 JSON_ELEMENTADD   *(16)                1103D
                            PROTOTYPE
 *RNF7031 JSON_ELEMENTCOPY  PROTOTYPE            1045D
 *RNF7031 JSON_ELEMENTDELETE...
                            PROTOTYPE            1061D
 *RNF7031 JSON_ELEMENTTYPE  I(5,0)               1096D
                            PROTOTYPE
 *RNF7031 JSON_ERROR        N(1)                  138D
                            PROTOTYPE
          JSON_EVAL         CONST                  76D
          JSON_FIELDS       CONST                 878D   1216
          JSON_FIRST_CHILD  CONST                 433D
 *RNF7031 JSON_FOREACH      N(1)                  732D
                            PROTOTYPE
 *RNF7031 JSON_GETATTR      A(32767)             1146D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRFIRST *(16)                 774D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNAME  A(32767)              785D
                            VARYING(2)
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     35
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNEXT  *(16)                 780D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRVALUE A(32767)              756D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETCHILD     *(16)                 226D
                            PROTOTYPE
 *RNF7031 JSON_GETDELIMITERS...
                            *(16)                  60D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMCHILD *(16)                1123D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNAME  A(32767)             1130D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNEXT  *(16)                1116D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMVALUE A(32767)             1137D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETILOBVALUE N(1)                  403D
                            PROTOTYPE
 *RNF7031 JSON_GETINT       I(20,0)               392D
                            PROTOTYPE
 *RNF7031 JSON_GETLENGTH    I(10,0)               555D
                            PROTOTYPE
 *RNF7031 JSON_GETMESSAGEOBJECT...
                            *(16)                 151D
                            PROTOTYPE
 *RNF7031 JSON_GETNAME      A(32767)              337D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNAMEASPATH...
                            A(32767)              343D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNEXT      *(16)                 220D
                            PROTOTYPE
 *RNF7031 JSON_GETNODEATTRVALUE...
                            A(32767)              737D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNUM       P(30,15)              383D
                            PROTOTYPE
 *RNF7031 JSON_GETPARENT    *(16)                 232D
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     36
                            PROTOTYPE
 *RNF7031 JSON_GETSTR       A(32767)              360D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETSTRJOIN   A(32767)              370D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUE     A(32767)             1026D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEINT  I(20,0)               324D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUENUM  P(30,15)              316D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEPTR  *(16)                 330D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUESTR  A(32767)              308D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_HAS          N(1)                  182D
                            PROTOTYPE
 *RNF7031 JSON_HTTPREQUEST  *(16)                1006D
                            PROTOTYPE
          JSON_IGNORE_CASE  CONST                 552D
 *RNF7031 JSON_ISNODE       N(1)                  206D
                            PROTOTYPE
 *RNF7031 JSON_ISNULL       N(1)                  198D
                            PROTOTYPE
 *RNF7031 JSON_ISTRUE       N(1)                  190D
                            PROTOTYPE
 *RNF7031 JSON_ITERATOR     DS(145)               696D    714     722     733
                            BASED(PROTOTYPE+)
 *RNF7031   BREAK           N(1)                  710D
 *RNF7031   COMMA           A(1)                  703D
                            VARYING(2)
 *RNF7031   COUNT           I(10,0)               704D
 *RNF7031   FILLER          A(64)                 711D
 *RNF7031   ISFIRST         N(1)                  700D
 *RNF7031   ISLAST          N(1)                  701D
 *RNF7031   ISLIST          N(1)                  699D
 *RNF7031   ISRECURSIVE     N(1)                  702D
 *RNF7031   LENGTH          I(10,0)               705D
 *RNF7031   LISTARR         *(16)                 708D
 *RNF7031   ROOT            *(16)                 697D
 *RNF7031   SIZE            I(10,0)               706D
 *RNF7031   THIS            *(16)                 698D
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     37
          JSON_LAST_CHILD   CONST                 434D
          JSON_LITERAL      CONST                  80D
 *RNF7031 JSON_LOCATE       *(16)                 165D
                            PROTOTYPE
 *RNF7031 JSON_LOCATEORCREATE...
                            *(16)                 173D
                            PROTOTYPE
 *RNF7031 JSON_LOOKUPVALUE  *(16)                 541D
                            PROTOTYPE
 *RNF7031 JSON_MAPIX        N(1)                  826D
                            PROTOTYPE
 *RNF7031 JSON_MEMLEAK      N(1)                  802D
                            PROTOTYPE
 *RNF7031 JSON_MEMSTAT      PROTOTYPE             806D
 *RNF7031 JSON_MEMUSE       U(20,0)               810D
                            PROTOTYPE
 *RNF7031 JSON_MERGE        *(16)                 561D
                            PROTOTYPE
 *RNF7031 JSON_MERGEOBJECTS *(16)                 575D
                            PROTOTYPE
 *RNF7031 JSON_MESSAGE      A(1024)               144D
                            VARYING(2)
                            PROTOTYPE
          JSON_META         CONST                 876D   1216
          JSON_MOVE_MODES   CONST                  90D
          JSON_MOVE_UNLINK  CONST                 503D
 *RNF7031 JSON_MOVEOBJECTINTO...
                            *(16)                 585D
                            PROTOTYPE
 *RNF7031 JSON_NEWARRAY     *(16)                 487D
                            PROTOTYPE
 *RNF7031 JSON_NEWOBJECT    *(16)                 480D
                            PROTOTYPE
 *RNF7031 JSON_NODEADD      *(16)                 444D
                            PROTOTYPE
 *RNF7031 JSON_NODECHECKSUM U(10,0)               475D
                            PROTOTYPE
 *RNF7031 JSON_NODECLONE    *(16)                 438D
                            PROTOTYPE
 *RNF7031 JSON_NODECOPY     PROTOTYPE             423D
 *RNF7031 JSON_NODEDELETE   PROTOTYPE             457D
 *RNF7031 JSON_NODERENAME   N(1)                  212D
                            PROTOTYPE
 *RNF7031 JSON_NODESANITIZE PROTOTYPE             468D
 *RNF7031 JSON_NODETYPE     I(5,0)                352D
                            PROTOTYPE
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     38
 *RNF7031 JSON_NODEUNLINK   *(16)                 463D
                            PROTOTYPE
          JSON_OBJCOPY      CONST                  83D
          JSON_OBJECT       CONST                  74D
          JSON_OBJLINK      CONST                  81D
          JSON_OBJMOVE      CONST                  85D
          JSON_OBJREPLACE   CONST                  82D
          JSON_PARSE        CONST                  96D
 *RNF7031 JSON_PARSEFILE    *(16)                 116D
                            PROTOTYPE
 *RNF7031 JSON_PARSESTRING  *(16)                 124D
                            PROTOTYPE
          JSON_POINTER_VALUE...
                            CONST                  77D
          JSON_REPLACE      CONST                 572D
          JSON_ROOT         CONST                  79D
          JSON_ROWARRAY     CONST                 874D
          JSON_SAME_CASE    CONST                 551D
 *RNF7031 JSON_SEGMENTDISPOSE...
                            PROTOTYPE             820D
 *RNF7031 JSON_SEGMENTSELECTNO...
                            *(16)                 814D
                            PROTOTYPE
 *RNF7031 JSON_SETATTRVALUE PROTOTYPE             764D
 *RNF7031 JSON_SETBOOL      *(16)                 270D
                            PROTOTYPE
 *RNF7031 JSON_SETCCSID     PROTOTYPE            1158D
 *RNF7031 JSON_SETDEC       *(16)                1166D
                            PROTOTYPE
 *RNF7031 JSON_SETDECPOINT  PROTOTYPE             132D
 *RNF7031 JSON_SETDELIMITERS...
                            PROTOTYPE              63D
 *RNF7031 JSON_SETEVAL      *(16)                 237D
                            PROTOTYPE
 *RNF7031 JSON_SETINT       *(16)                 252D
                            PROTOTYPE
 *RNF7031 JSON_SETITERATOR  DS(145)               714D
                            PROTOTYPE
 *RNF7031 JSON_SETNODEATTRVALUE...
                            PROTOTYPE             747D
 *RNF7031 JSON_SETNUM       *(16)                 261D
                            PROTOTYPE
 *RNF7031 JSON_SETPROCPTR   *(16)                 288D
                            PROTOTYPE
 *RNF7031 JSON_SETPTR       *(16)                 279D
                            PROTOTYPE
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     39
 *RNF7031 JSON_SETRECURSIVEITERATOR...
                            DS(145)               722D
                            PROTOTYPE
 *RNF7031 JSON_SETSTR       *(16)                 243D
                            PROTOTYPE
 *RNF7031 JSON_SETVALUE     *(16)                 297D
                            PROTOTYPE
 *RNF7031 JSON_SQLCLOSE     PROTOTYPE             933D
 *RNF7031 JSON_SQLCODE      I(10,0)              1002D
                            PROTOTYPE
 *RNF7031 JSON_SQLCOLUMNS   I(10,0)               919D
                            PROTOTYPE
 *RNF7031 JSON_SQLCONNECT   *(16)                 992D
                            PROTOTYPE
          JSON_SQLDISCONNECT...
                            PROTOTYPE             998D   1226M
 *RNF7031 JSON_SQLEXEC      N(1)                  940D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHNEXT *(16)                 912D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHRELATIVE...
                            *(16)                 902D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETINSERTID...
                            I(10,0)               983D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETMETA   *(16)                 987D
                            PROTOTYPE
 *RNF7031 JSON_SQLINSERT    N(1)                  961D
                            PROTOTYPE
 *RNF7031 JSON_SQLOPEN      *(16)                 893D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTROW *(16)                 847D
                            PROTOTYPE
          JSON_SQLRESULTSET *(16)                 856D   1212
                            PROTOTYPE
 *RNF7031 JSON_SQLROWS      I(10,0)               927D
                            PROTOTYPE
 *RNF7031 JSON_SQLSETOPTIONS...
                            PROTOTYPE             840D
 *RNF7031 JSON_SQLUPDATE    N(1)                  949D
                            PROTOTYPE
 *RNF7031 JSON_SQLUPSERT    N(1)                  971D
                            PROTOTYPE
 *RNF7031 JSON_STREAM       *(16)                 661D
                            PROTOTYPE
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     40
 *RNF7031 JSON_SUCCESSTRUE  *(16)                 159D
                            PROTOTYPE
          JSON_TOTALROWS    CONST                 881D
 *RNF7031 JSON_TRACESETID   PROTOTYPE            1018D
          JSON_UNKNOWN      CONST                  73D
          JSON_UPPERCASE    CONST                 883D
          JSON_USE_LOCALE   CONST                 538D
          JSON_VALUE        CONST                  78D
 *RNF7031 JSON_WRITECSVSTMF PROTOTYPE             667D
          JSON_WRITEJSONSTMF...
                            PROTOTYPE             607D   1220M
 *RNF7031 JSON_WRITESTMF    PROTOTYPE            1178D
 *RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             636D
 *RNF7031 JSON_XPATHVALUE   A(32767)             1074D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_XPATHVALUENUM...
                            P(30,15)             1085D
                            PROTOTYPE
          LIMIT             I(10,0)              1201D   1211M   1215
          MO_MERGE_MATCH    CONST                 106D
          MO_MERGE_NEW      CONST                 104D
          MO_MERGE_REPLACE  CONST                 109D
          PROTOTYPE_ONLY    *(16)                 681     696
          PROWS             *(16)                1198D   1212M   1220    1225
          SQL               A(512)               1199D   1206M   1213
                            VARYING(2)
          START             I(10,0)              1200D   1210M   1214
 *RNF7031 XML_WRITESTMF     PROTOTYPE            1188D
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                     1229M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     41
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          jx_Has                                  182
          jx_Dump                                 593
          jx_Error                                138
          jx_Clear                                792
          jx_Close                                797    1225
          jx_MapIx                                826
          jx_IsTrue                               190
          jx_IsNull                               198
          jx_isNode                               206
          jx_Stream                               661
          jx_MemUse                               810
          jx_Message                              144
          jx_GetNode                              165
          jx_NodeAdd                              444    1103
          jx_ForEach                              732
          jx_MemLeak                              802
          jx_MemStat                              806
          jx_sqlOpen                              893
          jx_sqlRows                              927
          jx_sqlExec                              940
          jx_sqlCode                             1002
          jx_NodeCopy                             423    1036    1045
          jx_NewArray                             487
          jx_sqlClose                             933
          jx_SetCcsid                            1158
          jx_ParseFile                            116
          jx_CopyValue                            412
          jx_NodeClone                            438
          jx_NewObject                            480
          jx_ArrayPush                            493
          jx_ArraySort                            529
          jx_getLength                            555
          jx_NodeMerge                            561
          jx_AsXmlText                            648
          jx_sqlUpdate                            949
          jx_sqlInsert                            961
          jx_sqlUpsert                            971
          jx_NodeRename                           212
          jx_GetValueVC                           360    1026    1075
          jx_NodeDelete                           457    1055    1061
          jx_NodeUnlink                           463
          jx_ArraySlice                           517
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     42
          jx_AsJsonText                           620    1067
          jx_sqlColumns                           919
          jx_sqlGetMeta                           987
          jx_sqlConnect                           992
          jx_traceSetId                          1018
          jx_ParseString                          124
          jx_SetDecPoint                          132
          jx_SuccessTrue                          159
          jx_GetNodeNext                          220    1116
          jx_GetNodeType                          352    1096
          jx_GetValueNum                          383    1086
          jx_GetValueInt                          392
          jx_ArrayAppend                          507
          jx_lookupValue                          541
          jx_CloneFormat                          599
          jx_SetIterator                          715
          jx_GetAttrNext                          780
          jx_httpRequest                         1006
          jx_GetNodeChild                         226    1123
          jx_SetStrByName                         243
          jx_SetIntByName                         252
          jx_SetDecByName                         261    1166
          jx_SetPtrByName                         279     288
          jx_GetStrJoinVC                         371
          jx_NodeSanitize                         468
          jx_NodeCheckSum                         475
          jx_MergeObjects                         575
          jx_NodeMoveInto                         585
          jx_WriteXmlStmf                         636    1188
          jx_AsXmlTextMem                         653
          jx_WriteCsvStmf                         667
          jx_SetAttrValue                         764
          jx_GetAttrFirst                         774
          jx_sqlResultRow                         847
          jx_sqlResultSet                         856    1217
          jx_sqlFetchNext                         912
          jx_GetDelimiters                         60
          jx_GetNodeParent                        232
          jx_SetEvalByName                        237
          jx_SetBoolByName                        270
          jx_GetNodeNameVC                        338    1131
          ILOB_XmlGetValue                        403
          jx_WriteJsonStmf                        607    1178    1222
          jx_AsJsonTextMem                        626
          jx_GetAttrNameVC                        786
          jx_sqlSetOptions                        840
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     43
          jx_sqlDisconnect                        998    1226
          jx_SetDelimiters2                        63
          jx_SetValueByName                       297
          jx_GetNodeValueVC                       309    1138
          jx_GetAttrValueVC                       757
          jx_SegmentDispose                       820
          jx_sqlGetInsertId                       983
          jx_GetOrCreateNode                      174
          jx_GetNodeValueNum                      317
          jx_GetNodeValueInt                      324
          jx_GetNodeValuePtr                      330
          jx_SegmentSelectNo                      815
          jx_GetMessageObject                     152
          jx_SetNodeAttrValue                     747
          jx_sqlFetchRelative                     903
          jx_GetNodeNameAsPath                    344
          jx_GetNodeAttrValueVC                   738    1147
          jx_SetRecursiveIterator                 724
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     44
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00    147 The name or indicator is not referenced.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             NOXDB/JSONSQL07A         DKSRV206   17-07-19 15:16:57        Page     45
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :      147
     Warning      (10) . . . . . . . :        0
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :      147
   Source Totals:
     Records . . . . . . . . . . . . :     1229
     Specifications  . . . . . . . . :      617
     Data records  . . . . . . . . . :        0
     Comments  . . . . . . . . . . . :      435
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program JSONSQL07A placed in library NOXDB. 00 highest severity. Created on 17-07-19 at 15:16:57.
           * * * * *   E N D   O F   C O M P I L A T I O N * * * * *
